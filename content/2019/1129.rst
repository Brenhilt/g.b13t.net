.. comment: chars from Lv1 to Lv6: #*=-^"


################################################################
2段階？2要素？認証のトークン発行するやつ
################################################################

:date: 2019/12/01
:category: technology
:tags: id,Android,totp
:slug: 01


Android上での話です．OTPを生成するアプリは色々有ります．

* Google 認証システム
* Microsoft Authenticator
* Salesforce Authenticator
* Blizzard Authenticator
* etc.

対応している各サービスで2段階認証用のQRをスキャンして登録するわけですが，各アプリによって登録後の可能な操作が異なるます．

QRの情報は概ね `Google AuthenticatorのGithubのページ`_ に書いてあるような情報:

.. _`Google AuthenticatorのGithubのページ`: https://github.com/google/google-authenticator/wiki/Key-Uri-Format

.. code-block:: spec

    otpauth://TYPE/LABEL?PARAMETERS

AWSのIAMで設定する際に表示されるQRだと，こう

.. code-block:: spec

    otpauth://totp/Amazon%20Web%20Services:<iam_name>@<account_name>?secret=<ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ01>&issuer=Amazon%20Web%20Services


会社の端末では下記4つ使ってます．

* Google 認証システム
* Microsoft Authenticator
* IIJ SmartKey
* Adobe Authenticator




違うな，IIJ SmartKeyはlabel?側のissuer見てるな．MS Authenticatorはissuerを別で格納してるのかな．書き換えてもアイコンは維持されてる．Google Authenticatorはissuer書き換え出来ない．んで1段




IIJ Smart: labelのissuer(書換可能且つunique制約)
Google Authen: parametersのissuer(書換不可)
MS Authen: labelのissuer(書換可能)


****************************************************************
Google 認証システム
****************************************************************

* これ使えばたいてい問題ないやつ．


****************************************************************
Microsoft Authenticator
****************************************************************

* MSがらみ(Office365とか)だとPush通知してくれるのが楽
* 登録フローの画面遷移がGoogleのと比べて1ページ多い．（「会社アカウント/個人アカウント/それ以外」の選択画面がQRスキャン前に差し込まれる）


****************************************************************
IIJ SmartKey
****************************************************************

* 国産
* トークンは画面下部に横並び．追加すると右に並んでいく．
* 鍵を選択すると画面中央にトークン表示．選択中以外のトークンは表示されない．


****************************************************************
Adobe Authenticator
****************************************************************

* 使い勝手はGoogleのと変わらない
